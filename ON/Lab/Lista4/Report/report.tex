\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[polish]{babel}
\usepackage[margin=1in]{geometry}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

\usepackage{booktabs} % Lepsza jakość tabel
\usepackage{graphicx}
\usepackage{float}
\usepackage{longtable}  % Dla tabel wielostronicowych

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{siunitx} 
\sisetup{
    output-exponent-marker = e,
    bracket-numbers = false,
    group-separator = {\,}, 
    scientific-notation = true
}

% Inne
\usepackage{hyperref} 
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Obliczenia Naukowe - Lista 1},
    pdfauthor={Wojciech Typer},
}

\title{Sprawozdanie z Laboratorium\\Obliczenia Naukowe - Lista 4}
\author{Wojciech Typer}

\begin{document}
\maketitle
\section*{Zadanie 1}
\subsection*{Cel zadania}
Celem zadania jest napisanie funkcji obliczającej ilorazy różnicowe. Funkcja ma przyjmować dwa argumenty: 
\begin{itemize}
    \item x $\rightarrow$ wektor długości n + 1 zawierający węzły: $x_{0} \text{, ..., } x_{n}$
    \item f $\rightarrow$ wektor długości n + 1 zawierający wartości interpolowanej funkcji w węzłach $f(x_{0} \text{, ..., } f(x_{n}))$
\end{itemize}
Funkcja ma zwracać $fx \rightarrow$ wektor długości n + 1, zawierający obliczone ilorazy róznicowe: 
\begin{center}
$fx = f[x_{0}] \text{, ..., } fx[n+1] = f[x_{0}, ..., x_{n}]$
\end{center}

\subsection*{Idea metody}
Obliczymy to na podstawie wzoru rekurencyjnego: iloraz rzędu k możemy policzyć na podstawie ilorazu rzędku k - 1:
\begin{center}
    $ f[x_{i} \text{, ..., } x_{i+k}] = \frac{f[x_{i+1} \text{, ..., } x_{i+k}] - f[x_{i} \text{, ..., } x_{i+k-1}]}{x_{i+k} - x_{i}}$
\end{center}

\subsection*{Implementacja}
\begin{algorithm}
\caption{Obliczanie ilorazów różnicowych (Newton)}
\begin{algorithmic}[1] % [1] włącza numerowanie linii
    \Require $x$: wektor węzłów ($x_0, \dots, x_n$)
    \Require $f$: wektor wartości funkcji ($f(x_0), \dots, f(x_n)$)
    \Ensure $fx$: wektor ilorazów różnicowych
    
    \Function{IlorazyRoznicowe}{$x, f$}
        \State $n \gets \text{length}(f) - 1$ 
        \State $fx \gets \text{copy}(f)$ 
        
        \Statex % Pusta linia dla czytelności
        
        \For{$j \gets 1$ \textbf{to} $n$} 
            \For{$i \gets n+1$ \textbf{downto} $j+1$} 
                \State $licznik \gets fx[i] - fx[i-1]$
                \State $mianownik \gets x[i] - x[i-j]$
                \State $fx[i] \gets \frac{licznik}{mianownik}$
            \EndFor
        \EndFor
        
        \State \Return $fx$
    \EndFunction
\end{algorithmic}
\end{algorithm}

\newpage
\section*{Zadanie 2}
\subsection*{Cel zadania}
Celem zadania jest napisanie funkcji obliczającej wartości wielomianu interpolacyjnego stopnia n w postaci Newtona za pomocą
uogólnionego schematu Hornera w czasie O(n).
Funkcja ma przyjmować trzy argumenty:
\begin{itemize}
    \item x $\rightarrow$ wektor długości n + 1 zawierający węzły: $x_{0} \text{, ..., } x_{n}$
    \item fx $\rightarrow$ wektor długości n + 1, zawierający ilorazy różnicowe: $fx = f[x_{0}] \text{, ..., } fx[n+1] = f[x_{0}, ..., x_{n}]$
    \item t $\rightarrow$ punkt, w którym liczymy wartość wielomianu
\end{itemize}
Funkcja ma zwracać wartość wielomianu interpolacyjnego w punkcie t.

\subsection*{Idea metody}
Wielomian Newtona możemy zapisać w postaci:
\begin{center}
$N_{n}(x) = c_{0} + c_{1}(x - x_{0}) + c_{2}(x - x_{0})(x - x_{1}) + \dots + c_{n}(x - x_{0})(x - x_{1}) \cdots (x - x_{n-1})$
\end{center}
Gdybyśmy chcieli policzyć każdy składnik osobno, to złożoność obliczeniowa wyniosłaby O(n$^{2}$). Możemy jednak skorzystać z uogólnionego schematu Hornera, który pozwala na obliczenie wartości wielomianu w czasie O(n):
\begin{center}
$N_{n}(x) = c_{0} + (t - x_{0}) \left( c_{1} + (t - x_{1}) \left( c_{2} + \dots + (t - x_{n-1}) c_{n} \right) \right)$
\end{center}
Słownie mówiąc, zaczynamy od ostatniego współczynnika $c_{n}$ i iteracyjnie dodajemy kolejne składniki, mnożąc je przez odpowiednie czynniki $(t - x_{i})$ i dodając $c_{i}$.

\subsection*{Implementacja}
\begin{algorithm}
\caption{Obliczanie wartości wielomianu Newtona (Schemat Hornera)}
\begin{algorithmic}[1]
    \Require $x$: wektor węzłów ($x_0, \dots, x_n$)
    \Require $fx$: wektor ilorazów różnicowych ($f[x_0], \dots, f[x_0, \dots, x_n]$)
    \Require $t$: punkt, w którym liczymy wartość
    \Ensure $nt$: wartość wielomianu w punkcie $t$
    
    \Function{WarNewton}{$x, fx, t$}
        \State $n \gets \text{length}(fx) - 1$ \Comment{Stopień wielomianu}
        \State $nt \gets fx[n+1]$ \Comment{Inicjalizacja ostatnim współczynnikiem}
        
        \Statex
        \For{$i \gets n$ \textbf{downto} $1$} \Comment{Iteracja od przedostatniego wyrazu}
            \State $nt \gets fx[i] + (t - x[i]) \cdot nt$
        \EndFor
        
        \State \Return $nt$
    \EndFunction
\end{algorithmic}
\end{algorithm}

\newpage

\section*{Zadanie 3}
\subsection*{Cel zadania}
Celem zadanie jest napisanie funkcji obliczającej w czasie $O(n^2)$ współczynniki wielomianu zapisanego w postaci naturalnej.
Funkcja ma przyjmować dwa argumenty:
\begin{itemize}
    \item x $\rightarrow$ wektor długości n + 1 zawierający węzły: $x_{0} \text{, ..., } x_{n}$
    \item fx $\rightarrow$ wektor długości n + 1, zawierający ilorazy różnicowe: $fx = f[x_{0}] \text{, ..., } fx[n+1] = f[x_{0}, ..., x_{n}]$
\end{itemize}
Funkcja ma zwracać wektor $a$ długości n + 1, zawierający współczynniki wielomianu w postaci naturalnej:
\begin{center}
$W_{n}(x) = a_{0} + a_{1} x + a_{2} x^{2} + ... + a_{n} x^{n}$
\end{center}

\subsection*{Idea metody}
Wielomian w postaci Newtona zadany jest wzorem:
\begin{center}
$N_{n}(x) = c_{0} + c_{1}(x - x_{0}) + c_{2}(x - x_{0})(x - x_{1}) + ... + c_{n}(x - x_{0})(x - x_{1}) ... (x - x_{n-1})$
\end{center}
Aby uzyskać postać naturalną, musimy wymnożyć wszystkie czynniki $(x-x_i)$ i uporządkować wyrazy według potęg $x$. Możemy to zrobić iteracyjnie, korzystając ze schematu Hornera do mnożenia wielomianów.
Algorytm polega na aktualizacji tablicy współczynników, "wciągając" kolejne czynniki $(x - x_k)$ do obliczonych już współczynników postaci naturalnej.
Złożoność obliczeniowa wynosi $O(n^2)$ ze względu na zagnieżdżone pętle (dla każdego z $n$ czynników wykonujemy do $n$ operacji aktualizacji).

\subsection*{Implementacja}
\begin{algorithm}
\caption{Konwersja postaci Newtona do postaci naturalnej}
\begin{algorithmic}[1]
    \Require $x$: wektor węzłów ($x_0, \dots, x_n$)
    \Require $fx$: wektor ilorazów różnicowych ($c_0, \dots, c_n$)
    \Ensure $a$: wektor współczynników postaci naturalnej ($a_0, \dots, a_n$)
    
    \Function{Naturalna}{$x, fx$}
        \State $n \gets \text{length}(fx) - 1$
        \State $a \gets \text{copy}(fx)$ 
        
        \Statex
        \For{$k \gets n$ \textbf{downto} $1$} \Comment{Iteracja po węzłach $x_{n-1}$ do $x_0$}
            \For{$j \gets k$ \textbf{to} $n$} \Comment{Aktualizacja współczynników}
                \State $a[j] \gets a[j] - a[j+1] \cdot x[k]$
            \EndFor
        \EndFor
        
        \State \Return $a$
    \EndFunction
\end{algorithmic}
\end{algorithm}

\newpage
\section*{Zadanie 4}
\subsection*{Cel zadania}
Celem zadania jest napisanie funkcji, która będzie interpolować zadaną funkcję f w przedziale [a, b]
za pomocą wielomianu interpolacyjnego stopnia n w postaci Newtona. Następnie funkcja ma za zadanie rysować wykres wielomianu interpolacyjnego i interpolowanej funkcji.
Funkcja ma przyjmować pięć argumentów:
\begin{itemize}
    \item f $\rightarrow$ funkcja anonimowa
    \item a $\rightarrow$ początek przedziału
    \item b $\rightarrow$ koniec przedziału
    \item n $\rightarrow$ stopień wielomianu interpolacyjnego
    \item wezly $\rightarrow$ typ węzłów: 'rownoodlegle' lub 'czebyszew'
\end{itemize}
W interpolacji należy użyć węzłów równoodległych, czyli: 
\begin{center}
    $x_{k} = a + kh$, gdzie $h = \frac{b-a}{n}$ 
\end{center}
lub węzłów będących zerami n + 1 wielomianu Czebyszewa, czyli:
\begin{center}
    $x_{k} = \frac{a+b}{2} + \frac{b-a}{2} \cos\left(\frac{(2k+1)\pi}{2(n+1)}\right)$
\end{center}

\subsection*{Implementacja}
\begin{algorithm}[H]
\caption{Pseudokod funkcji \texttt{rysujNnfx}}
\begin{algorithmic}[1]

\State Utwórz tablicę $x\_nodes$ o długości $n+1$

\If{wezly = rownoodlegle}
    \State $h \gets (b - a) / n$
    \For{$k = 0$ to $n$}
        \State $x\_nodes[k] \gets a + k \cdot h$
    \EndFor
\ElsIf{wezly = czebyszew}
    \For{$k = 1$ to $n+1$}
        \State $x\_raw \gets \cos\!\left( \frac{(2k-1)\pi}{2(n+1)} \right)$
        \State $x\_nodes[k-1] \gets \frac{a+b}{2} + \frac{b-a}{2} \cdot x\_raw$
    \EndFor
\Else
    \State Zgłoś błąd: "Nieznany typ węzłów"
\EndIf

\State $y\_nodes \gets f(x\_nodes)$  
\State $coeffs \gets$ ilorazyRoznicowe($x\_nodes$, $y\_nodes$)

\State Utwórz siatkę $x\_{plot}$ (1000 punktów na $[a,b]$)
\State $y\_{true} \gets f(x\_{plot})$
\State $y\_{interp} \gets$ wartości warNewton($x\_nodes$, $coeffs$, $t$) dla każdego $t$ z $x\_{plot}$

\State Narysuj wykres $f(x)$
\State Narysuj wykres $N_n(x)$ przerywaną linią
\State Narysuj punkty $(x\_nodes, y\_nodes)$ jako węzły
\State Ustaw etykiety osi i tytuł
\State Wyświetl wykres

\end{algorithmic}
\end{algorithm}

\newpage
\section*{Zadanie 5}
Celem zadania jest przetestowanie funkcji z poprzedniego zadania, na węzłach równoodległych na następujących przykładach:
\begin{itemize}
    \item $f(x) = e^{x}$ na przedziale [0, 1] dla n = 5, 10, 15
    \item $f(x) = x^2 \cdot \sin(x)$ na przedziale [-1, 1] dla n = 5, 10, 15
\end{itemize}

\subsection*{Wyniki}
Wyniki dla $f(x) = e^{x}$ na przedziale [0, 1]:

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/511.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/512.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/513.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\newpage
Wyniki dla $f(x) = x^2 \cdot \sin(x)$ na przedziale [-1, 1]:

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/521.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/522.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=01.0\textwidth, keepaspectratio]{../Examples/523.png}

    \label{fig:wykres-desmos}
    
\end{figure}

\subsection*{Wnioski}
Na powyższych wykresach widać, że zarówno dla $f(x) = e^{x}$ jak i dla $f(x) = x^2 \cdot \sin(x)$, już dla ilości węzłow n = 5, wielomian interpolacyjny
bardzo dobrze pokrywa się z wykresem funkcji. Zwiększanie ilości węzłów do n = 10 i n = 15 powoduje jedynie minimalne poprawienie dokładności interpolacji.
Możemy na tej podstawie wysnuć wnioski, że dla tych funkcji w przedziałach [0, 1] oraz [-1, 1], węzły równoodległe są wystarczające do uzyskania dobrej jakości interpolacji już przy niewielkiej liczbie węzłów.

\newpage
\section*{Zadanie 6}
Celem zadanie jest przetestowanie funkcji z zadania 4 na węzłach równoodległych i węzłach Czebyszewa na następujących przykładach:
\begin{itemize}
    \item $f(x) = |x|$ na przedziale [-1, 1] dla n = 5, 10, 15
    \item $f(x) = \frac{1}{1 + x^{2}}$ na przedziale [-1, 1] dla n = 5, 10, 15
\end{itemize}

\subsection*{Wyniki}
\textbf{Wyniki dla $f(x) = |x|$ na przedziale [-1, 1]:}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/611.png}

    \caption{Stopień wielomianu: 5, węzły równoodległe, $f(x) = |x|$} 

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/612.png}

        \caption{Stopień wielomianu: 10, węzły równoodległe, $f(x) = |x|$} 

    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/613.png}
    
    \caption{Stopień wielomianu: 15, węzły równoodległe, $f(x) = |x|$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/621.png}

    \caption{Stopień wielomianu: 5, węzły Czebyszewa, $f(x) = |x|$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/622.png}

    \caption{Stopień wielomianu: 10, węzły Czebyszewa, $f(x) = |x|$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/623.png}

    \caption{Stopień wielomianu: 15, węzły Czebyszewa, $f(x) = |x|$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\textbf{Wyniki dla $f(x) = \frac{1}{1 + x^{2}}$ na przedziale [-5, 5]:}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/631.png}

    \caption{Stopień wielomianu: 5, węzły równoodległe, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/632.png}

    \caption{Stopień wielomianu: 10, węzły równoodległe, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/633.png}

    \caption{Stopień wielomianu: 15, węzły równoodległe, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/641.png}

    \caption{Stopień wielomianu: 5, węzły Czebyszewa, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/642.png}

    \caption{Stopień wielomianu: 10, węzły Czebyszewa, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\begin{figure}[H] 
    
    \centering 

    \includegraphics[width=0.9\textwidth, keepaspectratio]{../Examples/643.png}

    \caption{Stopień wielomianu: 15, węzły Czebyszewa, $f(x) = \frac{1}{1 + x^{2}}$} 


    \label{fig:wykres-desmos}
    
\end{figure}

\subsection*{Wnioski}
Powyższe wykresy pokazują, że sytuacja w porównaniu z tą z zadania 5 jest zupełnie inna. 
Widzimy tu znaczną różnicę pomiędzy wielomianami interpolacyjnymi a funkcjami, a zwiększenie ilości węzłów 
nie poprawia znacznie jakości wielomianów interpolacynych.
Dla $f(x) = |x|$ lepiej prezentuje się sytuacja, w której użyto węzłów będących zerami wielomianu Czebyszewa.
W tej sutyacji wraz ze wzrostem stopnia wielomianu, jakość interpolacji się poprawia.
Dla $f(x) = \frac{1}{1 + x^{2}}$
\end{document}